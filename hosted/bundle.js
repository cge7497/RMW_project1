(()=>{"use strict";function e(e,t,n,o){let i=1;o&&(i=-1),n.clearRect(0,0,640,480),n.save(),n.beginPath(),n.arc(e,t-3*i,3,0,2*Math.PI),n.moveTo(e,t),n.lineTo(e,t+5*i),n.lineTo(e-2*i,t+8*i),n.moveTo(e,t+5*i),n.lineTo(e+2*i,t+8*i),n.moveTo(e-3*i,t+3*i),n.lineTo(e+3*i,t+3*i),n.stroke(),n.closePath(),n.restore()}function t(e,t,n,o,i,h,c){i.save(),i.beginPath(),i.moveTo(e,t),i.lineTo(e+n,t),i.lineTo(e+n,t+o),i.lineTo(e,t+o),i.closePath(),c?(i.fillStyle=h,i.fill()):(i.strokeStyle=h,i.lineWidth=3,i.stroke()),i.restore()}class n{constructor(e,t,n,o,i){this.x=e,this.y=t,this.width=n,this.height=o,this.color=i,this.hSpeed=o*n/15,this.vSpeed=0}}const o=[{x:280,y:800,width:31,height:30,color:"red"},{x:0,y:0,width:30,height:1e3,color:"blue"}];let i,h,c,r=[];const a={x:300,y:300,width:8,height:8,newX:300,newY:300};let d,l,s,u,w,y,x=2,v=!1,f=[],g=0,m=0,k=0;function S(){!function(){let e=0,t=0;f[65]&&(e=-1),f[68]&&(e=1),t=x,a.newX=a.x+e,a.newY=a.y+t;let n=function(e){const t=[];return o.forEach((n=>{e.newX<n.x+n.width&&e.newX+e.width>n.x&&e.newY<n.y+n.height&&e.newY+e.height>n.y&&t.push(n)})),t}(a);0==n.length?(a.x+=e,a.y+=t,m-=e,k-=t):(n.forEach((n=>{(function(e,t){return e.y>=t.y+t.height&&e.newY<t.y+t.height}(a,n)||function(e,t){return e.y+e.height<t.y&&e.newY+e.height>=t.y}(a,n))&&(a.newY-=t),(function(e,t){return e.x+e.width<t.x&&e.newX+e.width>=t.x}(a,n)||function(e,t){return e.x>=t.x+t.width&&e.newX<t.x+t.width}(a,n))&&(a.newX-=e)})),m+=a.x-a.newX,k+=a.y-a.newY,a.x=a.newX,a.y=a.newY)}(),e(a.x+m,a.y+k,h,v),o.forEach((e=>{t(e.x+m,e.y+k,e.width,e.height,h,e.color,!0)}))}function p(){c.clearRect(0,0,640,480),t(0,0,d,l,c,"white",!0),g+=0,r.forEach((function(e){e.hSpeed=1*Math.cos(g),e.vSpeed=1*Math.sin(g),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>d+20?e.x=-20:e.x<-20&&(e.x=d+20),e.y>l+20?e.y=-20:e.y<-20&&(e.y=l+20),t(e.x,e.y,e.width,e.height,c,e.color,!0)}))}function T(e){switch(e.keyCode){case 65:case 68:f[e.keyCode]=!0;break;case 32:e.preventDefault(),f[e.keyCode]||(x=-x,v=!v),f[e.keyCode]=!0}}function b(e){switch(e.keyCode){case 65:case 68:case 32:f[e.keyCode]=!1}}window.onload=function(){s=new Audio("./sounds/blue_walker.wav"),s.volume=.25,u=new Audio("./sounds/red_walker.wav"),u.volume=.25,w=new Audio("./sounds/green_spawn.wav"),w.volume=.25,y=new Audio("./sounds/green_get.wav"),y.volume=.25;let t=document.querySelector("#canvas_player"),o=document.querySelector("#canvas_walkers"),x=document.querySelector("#canvas_bg");document.querySelector("#btn_reset").onclick=function(){location.reload()},i=o.getContext("2d"),h=t.getContext("2d"),c=x.getContext("2d"),d=o.width,l=o.height,document.addEventListener("keydown",T),document.addEventListener("keyup",b),e(300,300,h,!1);for(let e=0;e<10;e++)r.push(new n(640*Math.random(),480*Math.random(),10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));p(),i.fillStyle="black",a.x=a.y=300,setInterval(S,1e3/60),setInterval(p,1e3/15)}})();