(()=>{"use strict";const e=(e,t,h,o)=>{let i=1;o&&(i=-1),h.clearRect(0,0,640,480),h.save(),h.beginPath(),h.arc(e,t-3*i,3,0,2*Math.PI),h.moveTo(e,t),h.lineTo(e,t+5*i),h.lineTo(e-2*i,t+8*i),h.moveTo(e,t+5*i),h.lineTo(e+2*i,t+8*i),h.moveTo(e-3*i,t+3*i),h.lineTo(e+3*i,t+3*i),h.stroke(),h.closePath(),h.restore()},t=(e,t,h,o,i,l,n)=>{i.save(),i.beginPath(),i.moveTo(e,t),i.lineTo(e+h,t),i.lineTo(e+h,t+o),i.lineTo(e,t+o),i.closePath(),n?(i.fillStyle=l,i.fill()):(i.strokeStyle=l,i.lineWidth=3,i.stroke()),i.restore()};class h{constructor(e,t,h,o,i){this.x=e,this.y=t,this.width=h,this.height=o,this.color=i,this.hSpeed=o*h/15,this.vSpeed=0}}const o=[{x:280,y:315,width:31,height:30,color:"red"},{x:0,y:0,width:30,height:800,color:"blue"},{x:0,y:950,width:30,height:502,color:"blue"},{x:-200,y:801,width:30,height:30,color:"red"},{x:-200,y:700,width:200,height:50,color:"blue"},{x:-200,y:998,width:200,height:50,color:"blue"},{x:-650,y:700,width:200,height:50,color:"blue"},{x:-650,y:998,width:200,height:50,color:"blue"},{x:-650,y:750,width:50,height:250,color:"blue"},{x:1e3,y:0,width:30,height:1500,color:"green"},{x:0,y:1500,width:1030,height:30,color:"black"},{x:0,y:0,width:999,height:30,color:"lavender"}],i=[{x:-540,y:982,width:16,height:16,id:"screwattack"}];let l,n,a;const d=[],r=document.getElementById("screwattack"),c={x:300,y:300,halfWidth:4,halfHeight:7,newX:300,newY:300};let w,s,y,g,x,u,f=!1,v=!0,m=[],k=0,b=0,p=0;const S=()=>{T(),e(c.x+b,c.y+p,n,f),((e,t,h,o)=>{t.fillRect(e.x+h-e.width/2,e.y+o-e.height/2,e.width,e.height,"blue")})(c,n,b,p),X()},T=()=>{let e=0,t=0;m[65]&&(e=-2),m[68]&&(e=2),t=f?-3:3,c.newX=c.x+e,c.newY=c.y+t;let h=C(c);0==h.length?(c.x+=e,c.y+=t,b-=e,p-=t):(h.forEach((h=>{(_(c,h)||I(c,h))&&(c.newY-=t,v=!0),(M(c,h)||H(c,h))&&(c.newX-=e)})),b+=c.x-c.newX,p+=c.y-c.newY,c.x=c.newX,c.y=c.newY),E(c)},X=()=>{o.forEach((e=>{t(e.x+b,e.y+p,e.width,e.height,n,e.color,!0)})),i.forEach((e=>{n.drawImage(r,e.x+b,e.y+p)}))},Y=()=>{a.clearRect(0,0,640,480),t(0,0,w,s,a,"white",!0),k+=0,d.forEach((function(e){e.hSpeed=1*Math.cos(k),e.vSpeed=1*Math.sin(k),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>w+20?e.x=-20:e.x<-20&&(e.x=w+20),e.y>s+20?e.y=-20:e.y<-20&&(e.y=s+20),t(e.x,e.y,e.width,e.height,a,e.color,!0)}))},W=()=>{},C=e=>{const t=[];return o.forEach((h=>{e.newX-e.halfWidth<h.x+h.width&&e.newX+e.halfWidth>h.x&&e.newY-e.halfHeight<h.y+h.height&&e.newY+e.halfHeight>h.y&&t.push(h)})),t},E=e=>{i.forEach((t=>{e.newX-e.halfWidth<t.x+t.width&&e.newX+e.halfWidth>t.x&&e.newY-e.halfHeight<t.y+t.height&&e.newY+e.halfHeight>t.y&&i.splice(i.indexOf(t),1)}))},H=(e,t)=>e.x+e.halfWidth<=t.x&&e.newX+e.halfWidth>=t.x,M=(e,t)=>e.x-e.halfWidth>=t.x+t.width&&e.newX-e.halfWidth<t.x+t.width,_=(e,t)=>e.y+e.halfHeight<t.y&&e.newY+e.halfHeight>=t.y,I=(e,t)=>e.y-e.halfHeight>=t.y+t.height&&e.newY-e.halfHeight<t.y+t.height,P=e=>{switch(e.keyCode){case 65:case 68:m[e.keyCode]=!0;break;case 32:e.preventDefault(),!m[e.keyCode]&&v&&(f=!f,v=!1),m[e.keyCode]=!0}},A=e=>{switch(e.keyCode){case 65:case 68:case 32:m[e.keyCode]=!1}};window.onload=()=>{y=new Audio("./sounds/blue_walker.wav"),y.volume=.25,g=new Audio("./sounds/red_walker.wav"),g.volume=.25,x=new Audio("./sounds/green_spawn.wav"),x.volume=.25,u=new Audio("./sounds/green_get.wav"),u.volume=.25;let t=document.querySelector("#canvas_player"),o=document.querySelector("#canvas_walkers"),i=document.querySelector("#canvas_bg");l=o.getContext("2d"),n=t.getContext("2d"),a=i.getContext("2d"),w=o.width,s=o.height,document.addEventListener("keydown",P),document.addEventListener("keyup",A),e(300,300,n,!1);for(let e=0;e<10;e++)d.push(new h(640*Math.random(),480*Math.random(),10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));Y(),l.fillStyle="black",c.x=c.y=300,setInterval(S,1e3/60),setInterval(Y,1e3/15),setInterval(W,1e3)}})();