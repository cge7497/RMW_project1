(()=>{"use strict";const e=(e,t,o,n)=>{let a=1;n&&(a=-1),o.clearRect(0,0,640,480),o.save(),o.beginPath(),o.arc(e,t-3*a,3,0,2*Math.PI),o.moveTo(e,t),o.lineTo(e,t+5*a),o.lineTo(e-2*a,t+8*a),o.moveTo(e,t+5*a),o.lineTo(e+2*a,t+8*a),o.moveTo(e-3*a,t+3*a),o.lineTo(e+3*a,t+3*a),o.stroke(),o.closePath(),o.restore()},t=(e,t,o,n,a,h,l)=>{a.save(),a.beginPath(),a.moveTo(e,t),a.lineTo(e+o,t),a.lineTo(e+o,t+n),a.lineTo(e,t+n),a.closePath(),l?(a.fillStyle=h,a.fill()):(a.strokeStyle=h,a.lineWidth=3,a.stroke()),a.restore()};class o{constructor(e,t,o,n,a){this.x=e,this.y=t,this.width=o,this.height=n,this.color=a,this.hSpeed=n*o/15,this.vSpeed=0}}const n=[{x:280,y:800,width:31,height:30,color:"red"},{x:0,y:0,width:30,height:1e3,color:"blue"},{x:600,y:0,width:30,height:1e3,color:"green"},{x:0,y:600,width:1e3,height:30,color:"yellow"},{x:0,y:0,width:1e3,height:30,color:"lavender"}];let a,h,l,i=[];const r={x:300,y:300,halfWidth:4,halfHeight:7,newX:300,newY:300};let d,c,s,w,y,u,g=!1,v=[],x=0,m=0,f=0;const b=()=>{p(),e(r.x+m,r.y+f,h,g),((e,t,o,n)=>{t.fillRect(e.x+o-e.width/2,e.y+n-e.height/2,e.width,e.height,"blue")})(r,h,m,f),k()},p=()=>{let e=0,t=0;v[65]&&(e=-2),v[68]&&(e=2),t=g?-3:3,r.newX=r.x+e,r.newY=r.y+t;let o=M(r);0==o.length?(r.x+=e,r.y+=t,m-=e,f-=t):(o.forEach((o=>{(q(r,o)||L(r,o))&&(r.newY-=t),(C(r,o)||H(r,o))&&(r.newX-=e)})),m+=r.x-r.newX,f+=r.y-r.newY,r.x=r.newX,r.y=r.newY)},k=()=>{n.forEach((e=>{t(e.x+m,e.y+f,e.width,e.height,h,e.color,!0)}))},S=()=>{l.clearRect(0,0,640,480),t(0,0,d,c,l,"white",!0),x+=0,i.forEach((function(e){e.hSpeed=1*Math.cos(x),e.vSpeed=1*Math.sin(x),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>d+20?e.x=-20:e.x<-20&&(e.x=d+20),e.y>c+20?e.y=-20:e.y<-20&&(e.y=c+20),t(e.x,e.y,e.width,e.height,l,e.color,!0)}))},T=()=>{},M=e=>{const t=[];return n.forEach((o=>{e.newX-e.halfWidth<o.x+o.width&&e.newX+e.halfWidth>o.x&&e.newY-e.halfHeight<o.y+o.height&&e.newY+e.halfHeight>o.y&&t.push(o)})),t},H=(e,t)=>e.x+e.halfWidth<=t.x&&e.newX+e.halfWidth>=t.x,C=(e,t)=>e.x-e.halfWidth>=t.x+t.width&&e.newX-e.halfWidth<t.x+t.width,q=(e,t)=>e.y+e.halfHeight<t.y&&e.newY+e.halfHeight>=t.y,L=(e,t)=>e.y-e.halfHeight>=t.y+t.height&&e.newY-e.halfHeight<t.y+t.height,X=e=>{switch(e.keyCode){case 65:case 68:v[e.keyCode]=!0;break;case 32:e.preventDefault(),v[e.keyCode]||(g=!g),v[e.keyCode]=!0}},Y=e=>{switch(e.keyCode){case 65:case 68:case 32:v[e.keyCode]=!1}};window.onload=()=>{const e=document.querySelector("#playerForm");e.addEventListener("submit",(t=>(t.preventDefault(),(async e=>{const t=e.querySelector("#nameField"),o=e.querySelector("#ageField"),n=e.querySelector("#colorField"),a=`name=${t.value}&age=${o.value}&color=${n.value}`;(async e=>{const t=document.querySelector("#content");switch(e.status){case 200:t.innerHTML="<b>Success</b>";break;case 201:t.innerHTML="<b>Created</b>";break;case 204:return void(t.innerHTML="<b>Updated (No Content)</b>");case 400:t.innerHTML="<b>Bad Request</b>";break;default:t.innerHTML="Error code not implemented by client."}let o=await e.json();o.message&&(t.innerHTML+=`<p>${o.message}</p>`)})(await fetch("/addUser",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:a}))})(e),!1)))},window.onload=()=>{s=new Audio("./sounds/blue_walker.wav"),s.volume=.25,w=new Audio("./sounds/red_walker.wav"),w.volume=.25,y=new Audio("./sounds/green_spawn.wav"),y.volume=.25,u=new Audio("./sounds/green_get.wav"),u.volume=.25;let t=document.querySelector("#canvas_player"),n=document.querySelector("#canvas_walkers"),g=document.querySelector("#canvas_bg");document.querySelector("#btn_reset").onclick=function(){location.reload()},a=n.getContext("2d"),h=t.getContext("2d"),l=g.getContext("2d"),d=n.width,c=n.height,document.addEventListener("keydown",X),document.addEventListener("keyup",Y),e(300,300,h,!1);for(let e=0;e<10;e++)i.push(new o(640*Math.random(),480*Math.random(),10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));S(),a.fillStyle="black",r.x=r.y=300,setInterval(b,1e3/60),setInterval(S,1e3/15),setInterval(T,1e3),setInterval(drawOtherPlayerMovement,1e3/30)}})();