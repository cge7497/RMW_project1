(()=>{"use strict";function e(e,t,o,n){let i=1;n&&(i=-1),o.clearRect(0,0,640,480),o.save(),o.beginPath(),o.arc(e,t-3*i,3,0,2*Math.PI),o.moveTo(e,t),o.lineTo(e,t+5*i),o.lineTo(e-2*i,t+8*i),o.moveTo(e,t+5*i),o.lineTo(e+2*i,t+8*i),o.moveTo(e-3*i,t+3*i),o.lineTo(e+3*i,t+3*i),o.stroke(),o.closePath(),o.restore()}function t(e,t,o,n,i,h,l){i.save(),i.beginPath(),i.moveTo(e,t),i.lineTo(e+o,t),i.lineTo(e+o,t+n),i.lineTo(e,t+n),i.closePath(),l?(i.fillStyle=h,i.fill()):(i.strokeStyle=h,i.lineWidth=3,i.stroke()),i.restore()}class o{constructor(e,t,o,n,i){this.x=e,this.y=t,this.width=o,this.height=n,this.color=i,this.hSpeed=n*o/15,this.vSpeed=0}}const n=[{x:280,y:800,width:31,height:30,color:"red"},{x:0,y:0,width:30,height:1e3,color:"blue"},{x:600,y:0,width:30,height:1e3,color:"blue"},{x:0,y:600,width:1e3,height:30,color:"blue"},{x:0,y:0,width:1e3,height:30,color:"blue"}];let i,h,l,c=[];const d={x:300,y:300,width:8,height:8,newX:300,newY:300};let r,w,s,a,u,y,g=!1,x=[],f=0,v=0,m=0;function k(){!function(){let e=0,t=0;x[65]&&(e=-2),x[68]&&(e=2),t=g?-3:3,d.newX=d.x+e,d.newY=d.y+t;let o=function(e){const t=[];return n.forEach((o=>{e.newX-e.width<o.x+o.width&&e.newX+e.width>o.x&&e.newY-e.height<o.y+o.height&&e.newY+e.height>o.y&&t.push(o)})),t}(d);0==o.length?(d.x+=e,d.y+=t,v-=e,m-=t):(o.forEach((o=>{(function(e,t){return e.y+e.height<t.y&&e.newY+e.height>=t.y})(d,o)&&(d.newY-=t,console.log("collided on bottom.")),function(e,t){return e.x-e.width>=t.x+t.width&&e.newX-e.width<t.x+t.width}(d,o)&&(d.newX-=e,console.log("collided on left.")),function(e,t){return e.y-e.height>=t.y+t.height&&e.newY-e.height<t.y+t.height}(d,o)&&(d.newY-=t,console.log("collided top.")),function(e,t){return e.x+e.width<t.x&&e.newX+e.width>=t.x}(d,o)&&(d.newX-=e,console.log("collided right."))})),v+=d.x-d.newX,m+=d.y-d.newY,d.x=d.newX,d.y=d.newY)}(),e(d.x+v,d.y+m,h,g),function(e,t,o,n){t.fillRect(e.x+o,e.y+n,-e.width,-e.height,"blue")}(d,h,v,m),n.forEach((e=>{t(e.x+v,e.y+m,e.width,e.height,h,e.color,!0)}))}function b(){l.clearRect(0,0,640,480),t(0,0,r,w,l,"white",!0),f+=0,c.forEach((function(e){e.hSpeed=1*Math.cos(f),e.vSpeed=1*Math.sin(f),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>r+20?e.x=-20:e.x<-20&&(e.x=r+20),e.y>w+20?e.y=-20:e.y<-20&&(e.y=w+20),t(e.x,e.y,e.width,e.height,l,e.color,!0)}))}function p(e){switch(e.keyCode){case 65:case 68:x[e.keyCode]=!0;break;case 32:e.preventDefault(),x[e.keyCode]||(g=!g),x[e.keyCode]=!0}}function S(e){switch(e.keyCode){case 65:case 68:case 32:x[e.keyCode]=!1}}window.onload=function(){s=new Audio("./sounds/blue_walker.wav"),s.volume=.25,a=new Audio("./sounds/red_walker.wav"),a.volume=.25,u=new Audio("./sounds/green_spawn.wav"),u.volume=.25,y=new Audio("./sounds/green_get.wav"),y.volume=.25;let t=document.querySelector("#canvas_player"),n=document.querySelector("#canvas_walkers"),g=document.querySelector("#canvas_bg");document.querySelector("#btn_reset").onclick=function(){location.reload()},i=n.getContext("2d"),h=t.getContext("2d"),l=g.getContext("2d"),r=n.width,w=n.height,document.addEventListener("keydown",p),document.addEventListener("keyup",S),e(300,300,h,!1);for(let e=0;e<10;e++)c.push(new o(640*Math.random(),480*Math.random(),10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));b(),i.fillStyle="black",d.x=d.y=300,setInterval(k,1e3/60),setInterval(b,1e3/15)}})();