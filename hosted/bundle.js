(()=>{"use strict";const e=(e,t,h,o)=>{let l=1;o&&(l=-1),h.clearRect(0,0,640,480),h.save(),h.beginPath(),h.arc(e,t-3*l,3,0,2*Math.PI),h.moveTo(e,t),h.lineTo(e,t+5*l),h.lineTo(e-2*l,t+8*l),h.moveTo(e,t+5*l),h.lineTo(e+2*l,t+8*l),h.moveTo(e-3*l,t+3*l),h.lineTo(e+3*l,t+3*l),h.stroke(),h.closePath(),h.restore()},t=(e,t,h,o,l,i,n)=>{l.save(),l.beginPath(),l.moveTo(e,t),l.lineTo(e+h,t),l.lineTo(e+h,t+o),l.lineTo(e,t+o),l.closePath(),n?(l.fillStyle=i,l.fill()):(l.strokeStyle=i,l.lineWidth=3,l.stroke()),l.restore()};class h{constructor(e,t,h,o,l){this.x=e,this.y=t,this.width=h,this.height=o,this.color=l,this.hSpeed=o*h/15,this.vSpeed=0}}const o=[{x:280,y:315,width:31,height:30,color:"red"},{x:0,y:0,width:30,height:800,color:"blue"},{x:0,y:950,width:30,height:502,color:"blue"},{x:-200,y:801,width:30,height:30,color:"red"},{x:-200,y:700,width:200,height:50,color:"blue"},{x:-200,y:998,width:200,height:50,color:"blue"},{x:-650,y:700,width:200,height:50,color:"blue"},{x:-650,y:998,width:200,height:50,color:"blue"},{x:-650,y:750,width:50,height:250,color:"blue"},{x:1e3,y:0,width:30,height:1500,color:"green"},{x:0,y:1500,width:1030,height:30,color:"black"},{x:0,y:0,width:999,height:30,color:"lavender"}],l=[{x:-540,y:982,width:16,height:16,id:"screwattack"},{x:300,y:982,width:16,height:16,id:"morphball"}];let i,n,a;const d=[],c={screwattack:document.getElementById("screwattack"),morphball:document.getElementById("morphball")},r={screwattack:{obtained:!1,collected:function(){document.getElementById("screwattack").style.display="inline"}},morphball:{obtained:!1,collected:function(){document.getElementById("morphball").style.display="inline"}}},w={x:300,y:300,halfWidth:4,halfHeight:7,newX:300,newY:300};let s,y,g,x,u,f,m=!1,v=!0,b=[],k=0,p=0,E=0;const S=()=>{T(),e(w.x+p,w.y+E,n,m),((e,t,h,o)=>{t.fillRect(e.x+h-e.width/2,e.y+o-e.height/2,e.width,e.height,"blue")})(w,n,p,E),X()},T=()=>{let e=0,t=0;b[65]&&(e=-2),b[68]&&(e=2),t=m?-3:3,w.newX=w.x+e,w.newY=w.y+t;let h=C(w);0==h.length?(w.x+=e,w.y+=t,p-=e,E-=t):(h.forEach((h=>{(_(w,h)||P(w,h))&&(w.newY-=t,v=!0),(M(w,h)||I(w,h))&&(w.newX-=e)})),p+=w.x-w.newX,E+=w.y-w.newY,w.x=w.newX,w.y=w.newY),H(w)},X=()=>{o.forEach((e=>{t(e.x+p,e.y+E,e.width,e.height,n,e.color,!0)})),l.forEach((e=>{n.drawImage(c[e.id],e.x+p,e.y+E)}))},Y=()=>{a.clearRect(0,0,640,480),t(0,0,s,y,a,"white",!0),k+=0,d.forEach((function(e){e.hSpeed=1*Math.cos(k),e.vSpeed=1*Math.sin(k),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>s+20?e.x=-20:e.x<-20&&(e.x=s+20),e.y>y+20?e.y=-20:e.y<-20&&(e.y=y+20),t(e.x,e.y,e.width,e.height,a,e.color,!0)}))},W=()=>{},C=e=>{const t=[];return o.forEach((h=>{e.newX-e.halfWidth<h.x+h.width&&e.newX+e.halfWidth>h.x&&e.newY-e.halfHeight<h.y+h.height&&e.newY+e.halfHeight>h.y&&t.push(h)})),t},H=e=>{l.forEach((t=>{e.newX-e.halfWidth<t.x+t.width&&e.newX+e.halfWidth>t.x&&e.newY-e.halfHeight<t.y+t.height&&e.newY+e.halfHeight>t.y&&(r[t.id].collected(),l.splice(l.indexOf(t),1))}))},I=(e,t)=>e.x+e.halfWidth<=t.x&&e.newX+e.halfWidth>=t.x,M=(e,t)=>e.x-e.halfWidth>=t.x+t.width&&e.newX-e.halfWidth<t.x+t.width,_=(e,t)=>e.y+e.halfHeight<t.y&&e.newY+e.halfHeight>=t.y,P=(e,t)=>e.y-e.halfHeight>=t.y+t.height&&e.newY-e.halfHeight<t.y+t.height,A=e=>{switch(e.keyCode){case 65:case 68:b[e.keyCode]=!0;break;case 32:e.preventDefault(),!b[e.keyCode]&&v&&(m=!m,v=!1),b[e.keyCode]=!0}},B=e=>{switch(e.keyCode){case 65:case 68:case 32:b[e.keyCode]=!1}};window.onload=()=>{g=new Audio("./sounds/blue_walker.wav"),g.volume=.25,x=new Audio("./sounds/red_walker.wav"),x.volume=.25,u=new Audio("./sounds/green_spawn.wav"),u.volume=.25,f=new Audio("./sounds/green_get.wav"),f.volume=.25;let t=document.querySelector("#canvas_player"),o=document.querySelector("#canvas_walkers"),l=document.querySelector("#canvas_bg");i=o.getContext("2d"),n=t.getContext("2d"),a=l.getContext("2d"),s=o.width,y=o.height,document.addEventListener("keydown",A),document.addEventListener("keyup",B),e(300,300,n,!1);for(let e=0;e<10;e++)d.push(new h(640*Math.random(),480*Math.random(),10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));Y(),i.fillStyle="black",w.x=w.y=300,setInterval(S,1e3/60),setInterval(Y,1e3/15),setInterval(W,1e3)}})();